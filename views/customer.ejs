<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smoothie King</title>
    <link rel="stylesheet" href="/css/customerHome.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <link rel="canonical" href="https://getbootstrap.com/docs/5.2/examples/sticky-footer-navbar/">
    <!-- Script to use jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js">
    </script>
    <script>
        function redirectIndex() {
            window.location.href = "/";
        }
    </script>
    <script src="https://kit.fontawesome.com/a31f3aa58a.js" crossorigin="anonymous"></script>
    <!--Begin Google Translate-->
    <script type="text/javascript">
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({ pageLanguage: 'en' }, 'translate-container');
        }
    </script>
    <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    <!--End Google Translate-->
</head>

<body>

    <section>
        <!-- top nav bar -->
        <nav class="navbar sticky-top bg-light">
            <div class="container-fluid">
                <div id="home">
                    <div><i class="home fa-solid fa-house fa-xl" onclick="redirectIndex()"></i></div>
                </div>
                <a class="navbar-brand" href="#">
                    <img src="https://static.olocdn.net/img/smoothieking/logo/logo-wide.png?v=1668607499" alt="Logo"
                        width="60" height="40" class="d-inline-block align-text-top">
                </a>

                <!-- shopping cart to toggle sidebar (offcanvas element) -->
                <button class="cartButton btn btn-light" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasRight" aria-controls="offcanvasRight"><i
                        class="fa-solid fa-cart-shopping fa-xl"></i></button>

                <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight"
                    aria-labelledby="offcanvasRightLabel">
                    <div class="offcanvas-header">
                        <h5 id="offcanvasRightLabel">Your Order</h5>
                        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"
                            aria-label="Close"></button>
                    </div>

                    <!-- body where the order is displayed in cart goes here -->
                    <div class="offcanvas-body">
                        <% if (orderCustomer.items.length> 0) { %>
                            <ol class="list-group list-group-numbered">
                                <% for (let i=0; i < orderCustomer.items.length; i++) { %>
                                    <li class="list-group-item d-flex justify-content-between align-items-start">
                                        <div class="ms-2 me-auto">
                                            <div class="fw-bold">
                                                <%= orderCustomer.items[i].itemName %>
                                            </div>
                                            <%= "$" + orderCustomer.items[i].getTotalPrice() %>
                                        </div>
                                        <span name="cancelItemButton"
                                            class="cancelButton btn btn-sm  btn-dark ">X</span>
                                    </li>
                                    <!-- use this to track which item number so if clicked on X, it will remove that item from the list -->
                                    <p name="itemNumberToDelete" type="hidden" class="visually-hidden">
                                        <%= i %>
                                    </p>
                                    <% } %>
                            </ol>

                            <div class=" d-grid gap-1">
                                <button class="checkout btn btn-danger" type="button" name="checkoutButton">
                                    <div class="checkoutText">
                                        Checkout
                                    </div>
                                </button>
                            </div>

                            <% } else { %>
                                <p class="lead">Your cart is empty</p>
                                <% } %>
                    </div>
                </div>
            </div>
        </nav>

        <!-- carousel goes here -->
        <div class=" carouselContainer container-sm">
            <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="false">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active"
                        aria-current="true" aria-label="Slide 1"></button>
                    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1"
                        aria-label="Slide 2"></button>
                    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2"
                        aria-label="Slide 3"></button>
                    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="3"
                        aria-label="Slide 4"></button>
                </div>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="../images/ruleTheDay.png" class="d-block w-100" alt="...">
                        <div class="carousel-caption d-none d-md-block">
                            ~
                            <!-- EMPTY, no text :) -->
                        </div>
                    </div>
                    <div class="carousel-item">
                        <img src="../images/running1.png" class="d-block w-100" alt="...">
                        <div class="carousel-caption d-none d-md-block">
                            <h5>Get active</h5>
                            <p>With energy-dense blends</p>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <img src="../images/sunny-forest.jpg" class="d-block w-100" alt="...">
                        <div class="carousel-caption d-none d-md-block">
                            <h5>Enjoy the finer things in life</h5>
                            <p>With delicious smoothies from our 'Treats' category</p>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <img src="../images/MSC2.jpg" class="d-block w-100" alt="...">
                        <div class="carousel-caption d-none d-md-block">
                            <h5>All available to you</h5>
                            <p>At our Smoothie King location at the MSC located on campus!</p>
                        </div>
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions"
                    data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions"
                    data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>

        <!-- weight loss -->
        <div class="weightLoss text-center" id="scroll-WeightLoss">
            <h2 class="display-2">
                Manage Weight
            </h2>
            <p class="lead">
                Blended to help you slim down, lighten up or reduce calories as part of a sensible diet and exercise
                plan.
            </p>
        </div>
        <% for (var i=0; i < weightloss.length; i++) { %>
            <div class="list-group" role="button">
                <a href="#" class="list-group-item list-group-item-action" aria-current="true">
                    <div>
                        <img src="../images/<%= weightloss[i].itemname %>.png" alt="image" width="164" height="214">

                    </div>
                    <div class="d-flex w-100 justify-content-between">
                        <h3 class="mb-1" id="smoothieName">
                            <%= weightloss[i].itemname %>
                        </h3>
                        <large id="smoothiePrice">
                            <%= "$" + weightloss[i].price %>
                        </large>
                    </div>
                    <% for (var j=0; j < weightlossIngredients[i].length; j++) { %>
                        <% if (j !=weightlossIngredients[i].length - 1) { %>
                            <small class="mb-1" name="ingredients">
                                <%= weightlossIngredients[i][j] + "," %>
                            </small>
                            <% } else { %>
                                <small class="mb-1" name="ingredients">
                                    <%= weightlossIngredients[i][j] %>
                                </small>
                                <% } %>
                                    <% } %>
                </a>
            </div>
            <% } %>

                <!-- get fit -->
                <div class="getFit text-center" id="scroll-GetFit">
                    <h2 class="display-2">
                        Get Fit
                    </h2>
                    <p class="lead">
                        Blended to help you get toned, build muscle, last longer or recover faster when added to your
                        fitness regimen.
                    </p>
                </div>
                <% for (var i=0; i < fitness.length; i++) { %>
                    <div class="list-group" role="button">
                        <a href="#" class="list-group-item list-group-item-action" aria-current="true">
                            <div>
                                <img src="../images/<%= fitness[i].itemname %>.png" alt="image" width="164"
                                    height="214">

                            </div>
                            <div class="d-flex w-100 justify-content-between">
                                <h3 class="mb-1" id="smoothieName">
                                    <%= fitness[i].itemname %>
                                </h3>
                                <large id="smoothiePrice">
                                    <%= "$" + fitness[i].price %>
                                </large>
                            </div>
                            <% for (var j=0; j < fitnessIngredients[i].length; j++) { %>
                                <% if (j !=fitnessIngredients[i].length - 1) { %>
                                    <small class="mb-1" name="ingredients">
                                        <%= fitnessIngredients[i][j] + "," %>
                                    </small>
                                    <% } else { %>
                                        <small class="mb-1" name="ingredients">
                                            <%= fitnessIngredients[i][j] %>
                                        </small>
                                        <% } %>
                                            <% } %>
                        </a>
                    </div>
                    <% } %>

                        <!-- treat -->
                        <div class="getTreat text-center" id="scroll-Treat">
                            <h2 class="display-2">
                                Enjoy A Treat
                                </h1>
                                <p class="lead">
                                    Purposefully blended to help you reward yourself or simply enjoy the day.
                                </p>
                        </div>
                        <% for (var i=0; i < treat.length; i++) { %>
                            <div class="list-group" role="button">
                                <a href="#" class="list-group-item list-group-item-action" aria-current="true">
                                    <div>
                                        <img src="../images/<%= treat[i].itemname %>.png" alt="image" width="164"
                                            height="214">

                                    </div>
                                    <div class="d-flex w-100 justify-content-between">
                                        <h3 class="mb-1" id="smoothieName">
                                            <%= treat[i].itemname %>
                                        </h3>
                                        <large id="smoothiePrice">
                                            <%= "$" + treat[i].price %>
                                        </large>
                                    </div>
                                    <% for (var j=0; j < treatIngredients[i].length; j++) { %>
                                        <% if (j !=treatIngredients[i].length - 1) { %>
                                            <small class="mb-1" name="ingredients">
                                                <%= treatIngredients[i][j] + "," %>
                                            </small>
                                            <% } else { %>
                                                <small class="mb-1" name="ingredients">
                                                    <%= treatIngredients[i][j] %>
                                                </small>
                                                <% } %>
                                                    <% } %>
                                </a>
                            </div>
                            <% } %>

                                <!-- be well  -->
                                <div class="getBeWell text-center" id="scroll-BeWell">
                                    <h2 class="display-2">
                                        Be Well
                                    </h2>
                                    <p class="lead">
                                        Blended to help you support immune health, get vitamins & minerals or simply
                                        feel better when added to a healthy diet. </p>
                                </div>
                                <% for (var i=0; i < bewell.length; i++) { %>
                                    <div class="list-group" role="button">
                                        <a href="#" class="list-group-item list-group-item-action" aria-current="true">
                                            <div>
                                                <img src="../images/<%= bewell[i].itemname %>.png" alt="image"
                                                    width="164" height="214">

                                            </div>
                                            <div class="d-flex w-100 justify-content-between">
                                                <h3 class="mb-1" id="smoothieName">
                                                    <%= bewell[i].itemname %>
                                                </h3>
                                                <large id="smoothiePrice">
                                                    <%= "$" + bewell[i].price %>
                                                </large>
                                            </div>
                                            <% for (var j=0; j < bewellIngredients[i].length; j++) { %>
                                                <% if (j !=bewellIngredients[i].length - 1) { %>
                                                    <small class="mb-1" name="ingredients">
                                                        <%= bewellIngredients[i][j] + "," %>
                                                    </small>
                                                    <% } else { %>
                                                        <small class="mb-1" name="ingredients">
                                                            <%= bewellIngredients[i][j] %>
                                                        </small>
                                                        <% } %>
                                                            <% } %>
                                        </a>
                                    </div>
                                    <% } %>



    </section>
    <footer class="sticky-bottom footer mt-auto py-3 bg-light">
        <div class="container">
            <span class="text-muted">
                <ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0 ">
                    <li><a href="#scroll-GetFit" class="nav-link px-2 link-dark " role="button">Get Fit</a>
                    </li>
                    <li><a href="#scroll-WeightLoss" class="nav-link px-2 link-dark" role="button">Manage Weight</a>
                    </li>
                    <li><a href="#scroll-Treat" class="nav-link px-2 link-dark" role="button">Enjoy A Treat</a>
                    </li>
                    <li><a href="#scroll-BeWell" class="nav-link px-2 link-dark" role="button">Be Well</a></li>
                    <li>
                        <div class="googleTranslate" id="translate-container"></div>
                    </li>
                </ul>
            </span>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous">

            // makes it so the browser scrolls to correct place for each category
            const navigationHeight = document.querySelector('.navbar').offsetHeight;
            document.documentElement.style.setProperty('--scroll-padding', `${navigationHeight}px`);

        </script>
    <script>
        // adds a click listener to all smoothie options
        const options = document.querySelectorAll("div.list-group");
        options.forEach((option) => {
            option.addEventListener('click', (event) => {

                let itemname = event.currentTarget.querySelector("#smoothieName").innerText;
                for (var i = 0; i < itemname.length; i++) {
                    if (itemname[i] == " ") {
                        itemname = itemname.replace(" ", "*");
                    }
                }
                var request = new XMLHttpRequest();
                request.open('GET', '/customerSmoothie?itemname=' + itemname, true);
                request.send();
                request.onload = function () {
                    window.location.href = "customerSmoothie?itemname=" + itemname;
                }
            });
        });

        $(document).ready(function () {
            // create listener for checkout button
            $('[name="checkoutButton"]').click(function () {
                console.log("checkout button clicked");
                // send request to server to display checkout page
                $.ajax({
                    url: '/customerCheckoutForm',
                    type: 'GET',
                    success: function (result) {
                        console.log("success");
                        window.location.href = "customerCheckoutForm";
                    }
                });
            });

            // listener for the remove item button
            $('[name="cancelItemButton"]').click(function () {
                console.log("cancel item button clicked");
                // get the index number of the item to be removed
                let index = Number($('[name="itemNumberToDelete"]').text().trim());
                // send post request to server to remove item from cart
                var data = {
                    removeItem: true,
                    index: index
                };
                var request = new XMLHttpRequest();
                request.open("POST", "/customer", true);
                request.setRequestHeader("Content-Type", "application/json");
                request.send(JSON.stringify(data));
                window.location.reload();
            });
        });


    </script>

</body>

</html>